\RequirePackage[hyperref]{doc}
\codeline@indexfalse
\let\special@index\index
\RequirePackage{listings}
\usepackage{amsmath}

\AddToHook{begindocument}{%
  \hypersetup{%
    colorlinks=false
   ,hidelinks
   ,pdfborder={0 0 0}
 }%
 \usepackage{bookmark}%
}

%%%%%%%%%%%
% Colours %
%%%%%%%%%%%
\definecolor{link}{cmyk}{0.00,0.00,0.00,1.00}
\definecolor{spot}{cmyk}{0.00,0.82,0.59,0.18}

\definecolor{contcolor}{cmyk}{0.00,0.00,1.00,0.20}
\definecolor{compcolor}{cmyk}{1.00,1.00,0.00,0.00}
\definecolor{hookcolor}{cmyk}{1.00,0.00,1.00,0.00}
\definecolor{propcolor}{cmyk}{0.09,0.90,0.00,0.15}
\definecolor{tagscolor}{cmyk}{1.00,0.00,0.00,0.20}
\definecolor{attrcolor}{cmyk}{0.70,0.00,0.23,0.28}


%%%%%%%%%%%%%
% Type area %
%%%%%%%%%%%%%

\hoffset-1in
\voffset-1in
\topmargin14mm
\headheight1\baselineskip
\headsep\dimexpr16mm-\headheight\relax
\textwidth=140mm
\textheight=56\baselineskip
\oddsidemargin=56mm
\marginparwidth=46mm
\emergencystretch=2em
\marginparsep4mm

%%%%%%%%%
% Fonts %
%%%%%%%%%
\usepackage{newtxtext,newtxmath}
\let\mybfseries\bfseries
\let\sbseries\mybfseries
\def\bfseries{\mybfseries\sffamily}

\let\myttfamily\ttfamily
\DeclareTextFontCommand{\mytexttt}{\myttfamily}
\def\ttfamily{\myttfamily\small}
\def\titlefont{\mybfseries\sffamily\color{spot}}

\let\mytextbf\textbf
\def\textbf#1{{\small\bfseries\color{spot}#1\/}}

\parindent\z@
\parskip.5\baselineskip

\RequirePackage{marginnote}
\reversemarginpar

\def\ccNew#1{\marginnote{\textcolor{spot!90}{\sffamily\bfseries New #1}}}
\def\ccUpdate#1{\marginnote{\textcolor{spot!90}{\sffamily\bfseries Updated #1}}}
\def\marginfont{\sffamily\mdseries\footnotesize}
\def\marginnotevadjust{1.5bp}

\let\hack\@firstofone
\let\Hack\@firstofone
\let\hackfor\@gobble
\let\Hackfor\@gobble


%%%%%%%%%
% Lists %
%%%%%%%%%

\RequirePackage[replace]{coco-lists}
\ccAddToType{Properties}{Itemize}{%
  \ccSetProperty{label-sep}{\z@}%
  \ccSetProperty{indent}{-1em}%
  \ccSetProperty{label-align}{left}%
  \ccSetProperty{margin-left}{auto}%
}

\def\myitemlabel#1{\raise.25ex\hbox{\color{spot!#1}\rule{1ex}{1ex}}}
\ccAddToType{Properties}{Itemize-1}{\ccSetProperty{default-label}{\myitemlabel{100}}}
\ccAddToType{Properties}{Itemize-2}{\ccSetProperty{default-label}{\myitemlabel{50}}}
\ccAddToType{Properties}{Itemize-3}{\ccSetProperty{default-label}{\myitemlabel{30}}}
\ccAddToType{Properties}{Itemize-4}{\ccSetProperty{default-label}{\myitemlabel{10}}}


%%%%%%%%%%%%%%%
% page styles %
%%%%%%%%%%%%%%%

\def\htbar{{\color{spot}\rule[-\dp\strutbox]{.5\p@}{\dimexpr\ht\strutbox+\dp\strutbox\relax}}}
\newdimen\pageskip \pageskip3em\relax
\def\cleardoublepage{\clearpage\if@twoside \ifodd\c@page\else
    \hbox{}\thispagestyle{empty}\newpage\if@twocolumn\hbox{}\newpage\fi\fi\fi}
\def\ps@headings{%
  \let\@oddfoot\@empty\let\@evenfoot\@empty
  \def\@evenhead{\hskip-\pageskip\hbox to \pageskip{\hfill\bfseries\thepage\enskip}\htbar\enskip\leftmark\hfil}%
  \def\@oddhead{\hfill{\rightmark}\enskip\htbar\rlap{\hbox to \pageskip{\enskip\bfseries\thepage\hfill}}}%
  \let\@mkboth\markboth
  \def\chaptermark##1{%
    \markboth {%
      \ifnum \c@secnumdepth >\m@ne
        \if@mainmatter
          \thechapter\enskip
        \fi
      \fi
      ##1}{}}%
  \def\sectionmark##1{%
    \markright {%
      \ifnum \c@secnumdepth >\z@
        \if@mainmatter
          \thesection\enskip
        \fi
      \fi
      ##1}}}

\def\ps@chapfirst{%
  \let\@oddfoot\@empty\let\@evenfoot\@empty
  \let\@evenhead\@empty%
  \def\@oddhead{\hfill{\rightmark}\enskip\htbar\rlap{\hbox to \pageskip{\enskip\bfseries\thepage\hfill}}}%
  \let\@mkboth\markboth
  \def\chaptermark##1{%
    \markboth {%
      \ifnum \c@secnumdepth >\m@ne
        \if@mainmatter
          \thechapter\enskip
        \fi
      \fi
      ##1}{}}%
  \def\sectionmark##1{%
    \markright {%
      \ifnum \c@secnumdepth >\z@
        \thesection\enskip
      \fi
      ##1}}}

\pagestyle{headings}

%%%%%%%%%%%%%
% Titlepage %
%%%%%%%%%%%%%

\let\fileversion\@empty
\let\filedate\@empty

\def\Fileversion#1{\def\@fileversion{#1}}
\def\Filedate#1{\def\@filedate{#1}}

\AtBeginDocument{%
\renewcommand\tableofcontents{%
  {\begin{Heading}[notoc,nonumber]{toc}
     \Title{\contentsname}%
   \end{Heading}%
   \thispagestyle{empty}%
   \parskip\z@
   \@starttoc{toc}}%
}}

\ccAddToProperties{titlepage}{%
  \ccSetProperty{title-face}{\Huge\titlefont}%
  \ccSetProperty{subtitle-face}{\Large\mybfseries\sffamily}%
  \ccSetProperty{titlepage-roman}{%
    \thispagestyle{empty}%
    \vskip2\baselineskip
    \bgroup
      \raggedleft
      \bgroup
        \ccUseProperty{title-face}
        \ccUseComp{Title}%
        \par
      \egroup
      \vskip\baselineskip
      \bgroup
        \ccUseProperty{subtitle-face}
        \ccUseComp{Subtitle}%
        \par
      \egroup
      \vskip2\baselineskip
      {\large Version~\@fileversion}\par
      (\@filedate)\par
      \vskip\baselineskip
      \tableofcontents
    \egroup
  }
}

%%%%%%%%%%%%
% Headings %
%%%%%%%%%%%%

\ccAddToType{Properties}{Heading}{%
  \ccSetProperty{before-heading-block}{\parindent\z@ \parskip\z@ \leftskip\z@}
  \ccSetProperty{heading-block}{%
    \ccUseProperty{title-face}%
    \ccIfComp{Number}{\ccUseProperty{hang-number}}{\leftskip0pt}%
      {\ccUseComp{Title}}\par%
       \ccWhenComp{Subtitle}{{\ccUseProperty{subtitle-face}\ccUseComp{Subtitle}}\par}%
       \ccWhenComp{Author}{{\ccUseProperty{author-face}\ccUseComp{Author}}\par}%
       \ccWhenComp{Quote}{%
         \bgroup\ccUseProperty{quote-format}%
           \ccUseComp{Quote}\par
           \ccWhenComp{QuoteSource}{{\ccUseProperty{quote-source-format}--\space\ccUseComp{Quote}}\par}%
         \egroup}%
  }%
  \ccSetProperty{indent}{auto-global}%
  \ccSetProperty{number-sep}{\enskip}
}

\ccDeclareHeading{0}{chapter}{%
  \ccSetProperty{heading-par}{\cleardoublepage
    \par
    \global\@afterindenttrue
  }
  \ccSetProperty{before-heading}{%
    \thispagestyle{chapfirst}%
    \addtocontents{lof}{\protect\addvspace{1\baselineskip}}%
    \addtocontents{lot}{\protect\addvspace{1\baselineskip}}%
    \setcounter{section}{0}%
  }
  \ccSetProperty{title-face}{\huge\titlefont}
  \ccSetProperty{after-skip}{3\baselineskip}%
  \ccSetProperty{indent}{}
  \ccSetProperty{toc-margin-top}{1\baselineskip}
  \ccSetProperty{toc-title-face}{\bfseries\sffamily}
}

\ccDeclareHeading[chapter]{0}{toc}{%
  \ccSetProperty{heading-par}{\par
    \global\@afterindenttrue
  }%
}

\ccDeclareHeading{1}{section}{%
  \ccSetProperty{before-heading}{\raggedright\setcounter{subsection}{0}}%
  \ccSetProperty{before-skip}{2.5\baselineskip}
  \ccSetProperty{after-skip}{16bp}%
  \ccSetProperty{title-format}{\LARGE\titlefont\color{spot!95}}%
  \ccSetProperty{toc-margin-bottom}{\z@}
  \ccSetProperty{toc-margin-top}{.5\baselineskip}
}

\ccDeclareHeading{2}{subsection}{%
  \ccSetProperty{before-heading}{\raggedright\setcounter{subsubsection}{0}}%
  \ccSetProperty{before-skip}{2\baselineskip}
  \ccSetProperty{after-skip}{6bp}%
  \ccSetProperty{title-format}{\large\titlefont\color{spot!90}}%
  \ccSetProperty{toc-margin-bottom}{\z@}
  \ccSetProperty{toc-margin-top}{\z@}
}

\ccDeclareHeading{3}{subsubsection}{%
  \ccSetProperty{before-heading}{\raggedright}%
  \ccSetProperty{before-skip}{1.5\baselineskip}
  \ccSetProperty{before-heading}{\raggedright}%
  \ccSetProperty{before-skip}{1.5\baselineskip}
  \ccSetProperty{after-skip}{1sp}%
  \ccSetProperty{title-format}{\normalsize\titlefont\color{spot!85}}%
}

\ccDeclareHeading{4}{paragraph}{%
  \ccSetProperty{before-skip}{1\baselineskip}
  \ccSetProperty{after-skip}{1sp}%
  \ccSetProperty{title-format}{\normalsize\titlefont\color{spot!80}}%
  \ccSetProperty{numbering}{}
}

\ccDeclareHeading{5}{subparagraph}{%
  \ccSetProperty{before-skip}{.5\baselineskip}%
  \ccSetProperty{after-skip}{-.5em}%
  \ccSetProperty{title-format}{\small\titlefont\color{spot!75}}%
  \ccSetProperty{numbering}{}
}

\usepackage{ragged2e}

%%%%%%%%%%
% Floats %
%%%%%%%%%%

\ccAddToType{Properties}{float}{%
  \ccSetProperty{number-sep}{\enskip}%
  \ccSetProperty{number-face}{\bfseries\small\sffamily}%
  \ccSetProperty{caption-face}{\sffamily\small\RaggedRight}%
  \ccSetProperty{intext-skip-above}{1\baselineskip}%
  \ccSetProperty{intext-skip-below}{\dimexpr1\baselineskip-2.5bp\relax}%
  \ccSetProperty{subcaption-valign-above}{bottom}%
  \ccSetProperty{subcaption-valign-below}{top}%
}

\ccAddToType{Properties}{Figure}{%
  \ccSetProperty{caption-bottom}{}%
  \ccSetProperty{caption-top}{%
    \ccWhenComp{Number}{{\ccUseProperty{number-face}\ccUseComp{Number}\ccUseProperty{number-sep}}}%
    \ccUseComp{Caption}%
  }%
  \ccSetProperty{caption-sep-top}{1bp}
  \ccSetProperty{caption-sep-bottom}{4bp}
}

\ccAddToType{Properties}{Table}{%
  \ccSetProperty{caption-top}{%
    \ccWhenComp{Number}{{\ccUseProperty{number-face}\ccUseComp{Number}\ccUseProperty{number-sep}}}%
    \ccUseComp{Caption}%
    \ccWhenComp{Source}{\\\ccUseComp{Source}}%
  }%
  \ccSetProperty{caption-bottom}{\ccUseComp{Legend}}%
  \ccSetProperty{caption-sep-top}{1bp}%% vertical space between top caption and content
  \ccSetProperty{caption-sep-bottom}{4bp}
}

\RequirePackage{htmltabs}
\SetHTClass{}{%
  \SetClassProp{table}{margin}{0bp}%
  \SetClassProp{table}{break-table}{true}%
  \SetClassProp{table}{border}{2bp solid spot}%
  \SetClassProp{table}{border-top}{none}%
  \SetClassProp[thead]{td}{background-color}{spot}%
  \SetClassProp[thead]{td}{font-weight}{bold}%
  \SetClassProp[thead]{td}{vertical-align}{middle}%
  \SetClassProp[thead]{td}{color}{white}%
  \SetClassProp{td}{padding}{2bp 0.5mm 1bp}%
  \SetClassProp{td}{border-style}{none}%
  \SetClassProp{td}{font-family}{sans-serif}%
  \SetClassProp{td}{font-size}{x-small}%
}

\newcommand*{\fullref}[1]{\hyperref[{#1}]{\autoref*{#1} “\nameref*{#1}”}}

%%%%%%%%%%%%
% Listings %
%%%%%%%%%%%%

\lstset{%
  basicstyle={\ttfamily},
  firstnumber=last,
  literate={%
    {Ö}{{\"O}}1
    {Ä}{{\"A}}1
    {Ü}{{\"U}}1
    {ß}{{\ss}}1
    {ü}{{\"u}}1
    {ä}{{\"a}}1
    {ö}{{\"o}}1
    {¬}{{$\neg$}}1
    {«}{{\guillemotright}}1
    {»}{{\guillemotleft}}1
    {~}{{\textasciitilde}}1},
  inputencoding=utf8,
  language=[AlLaTeX]TeX,
  xleftmargin=\leftskip,
  % basicstyle=\fontfamily{lmvtt}\selectfont\small,
  columns=fullflexible,
  numbers=none,
  numberfirstline=1,
  numberstyle=\scriptsize,
  numbersep=5pt,
  backgroundcolor=\color{spot!04},  % choose the background color; you must add \usepackage{color} or \usepackage{xcolor}
  % basicstyle=\scriptsize,                    % the size of the fonts that are used for the code
  breakatwhitespace=false,           % sets if automatic breaks should only happen at whitespace
  breaklines=true,                   % sets automatic line breaking
  captionpos=t,                      % sets the caption-position
  commentstyle={\itshape\color{spot!70}},      % comment style
  frame=single,                      % adds a frame around the code
  keepspaces=true,                   % keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
  keywordstyle={\color{spot}\itshape},% keyword style
  identifierstyle={},
  texcsstyle={\color{spot}\mybfseries},% keyword style
  rulecolor=\color{spot},            % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. comments (green here))
  showspaces=false,                  % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
  showstringspaces=true,             % underline spaces within strings only
  showtabs=true,                     % show tabs within strings adding particular underscores
  stringstyle={\color{spot!80}},                    % string literal style
  tabsize=2,                         % sets default tabsize to 2 spaces
}

\lstdefinestyle{tex}{language=[latex]TeX,
  basicstyle=\ttfamily,
  classoffset=0,
    morekeywords={DeclareRobustCommand},
    keywordstyle=\color{spot},
    identifierstyle=\textup,
  classoffset=1,
    morekeywords={optional,rest,args},
    keywordstyle=\color{spot!85},
  classoffset=0,
  commentstyle=\color{spot!60}\footnotesize, %
  stringstyle=\itshape, %
  showstringspaces=false % no special string spaces
}

\lstdefinestyle{texinline}{language=[latex]TeX,
  basicstyle=\ttfamily,
  classoffset=0,
    morekeywords={DeclareRobustCommand},
    keywordstyle=\color{spot},
    identifierstyle=\textup,
  classoffset=1,
    morekeywords={optional,rest,args},
    keywordstyle=\color{spot!85},
  classoffset=0,
  commentstyle=\color{spot!60}\footnotesize, %
  stringstyle=\itshape, %
  showstringspaces=false % no special string spaces
}

\lstdefinestyle{bash}{language=bash,
  basicstyle=\ttfamily,
  commentstyle=\color{black!60}\footnotesize, %
  stringstyle=\itshape, %
  showstringspaces=false % no special string spaces
}

\usepackage{etoolbox}
\patchcmd{\lsthk@TextStyle}{\let\lst@DefEsc\@empty}{}{}{\errmessage{failed to patch}}
\global\let\lst@doendpe\@empty
\usepackage{multicol}

%%%%%%%%%
% Index %
%%%%%%%%%

\usepackage[noautomatic,splitindex,truexindy]{imakeidx}
\indexsetup{level=\section*}
\makeindex
\makeindex[name=macros]
\makeindex[name=properties]
\makeindex[name=containers]
\makeindex[name=components]
\makeindex[name=hooks]
\makeindex[name=tags]
\makeindex[name=attributes]

\def\seealso#1#2{\textit{see also}~#1}
\def\see#1#2{\textit{see}~#1}

\long\def\IndexPrologue#1{\long\gdef\index@prologue{#1}}
\long\def\PrintIndex{%
  \let\theindex\HDorg@theindex% otherwise all index sections get bookmarked as "Index..."
  \backmatter
  \begin{Heading}[nonumber]{chapter}
    \Title{Index}
  \end{Heading}
  In general, page entries in \textbf{bold face} refer to main sections that
  describe the index term in greater detail. Roman page numbers refer
  to pages where the entry is used.\par
  \raggedright \IndexPrologue{\gdef\indexcolor{spot!75}%
    \begin{Heading}[nonumber]{section}
      \Title{\color{\indexcolor}General Index}%
      \TocTitle{General Index}
      \RunTitle{Index -- General}
    \end{Heading}}%
  \@input@{\jobname-manual.ind}%
  \IndexPrologue{\gdef\indexcolor{spot!75}%
    \begin{Heading}[nonumber]{section}
      \Title{\color{\indexcolor}Macro and Environment Index}%
      \TocTitle{Macro and Environment Index}
      \RunTitle{Index -- Macros and Environments}
    \end{Heading}
    In this index, the \texttt{cc(@)}-Prefixes are omitted when
    sorting the entries.}%
  \@input@{\jobname-macros.ind}%
  \IndexPrologue{\gdef\indexcolor{contcolor!75}%
    \begin{Heading}[nonumber]{section}
      \Title{\color{\indexcolor}Container Index}%
      \TocTitle{Container Index}
      \RunTitle{Index -- Containers}
    \end{Heading}}
  \@input@{\jobname-containers.ind}%
  \IndexPrologue{\gdef\indexcolor{compcolor!75}%
    \begin{Heading}[nonumber]{section}
      \Title{\color{\indexcolor}Component Index}%
      \TocTitle{Component Index}
      \RunTitle{Index -- Components}
    \end{Heading}
    In this index, the specification in parentheses denote the
    (Parent) Container inside of which the Component is valid.}%
  \@input@{\jobname-components.ind}%
  \IndexPrologue{\gdef\indexcolor{propcolor!75}%
    \begin{Heading}[nonumber]{section}
      \Title{\color{\indexcolor}Property Index}%
      \TocTitle{Property Index}
      \RunTitle{Index -- Properties}
    \end{Heading}
    In this index, the specification in parentheses denote the
    (Parent) Container inside of which the Property is valid.}%
  \@input@{\jobname-properties.ind}%
  \IndexPrologue{\gdef\indexcolor{hookcolor!75}%
    \begin{Heading}[nonumber]{section}
      \Title{\color{\indexcolor}Hook Index}%
      \TocTitle{Hook Index}
      \RunTitle{Index -- Hooks}
    \end{Heading}}
  \@input@{\jobname-hooks.ind}%
  \IndexPrologue{\gdef\indexcolor{tagscolor!75}%
    \begin{Heading}[nonumber]{section}
      \Title{\color{\indexcolor}Tag Index}%
      \TocTitle{Tag Index}
      \RunTitle{Index -- Tags}
    \end{Heading}%
    In this index, \texttt{<tag>} refers to start tags,
    \texttt{</tag>} refers to end tags, and \texttt{</tag>} to tags in
    general.}
  \@input@{\jobname-tags.ind}%
  \IndexPrologue{\gdef\indexcolor{attrcolor!75}%
    \begin{Heading}[nonumber]{section}
      \Title{\color{\indexcolor}Attribute Index}%
      \TocTitle{Attribute Index}
      \RunTitle{Index -- Attributes}
    \end{Heading}%
    In this index, the specification in parentheses denote the
    (Parent) Container's Environment inside of which the Attribute is
    valid.}  \@input@{\jobname-attributes.ind}%
  \global\let\PrintIndex\@empty }

\let\Index\index

\def\MainTerm{\cc@opt@second\main@term}
\def\main@term[#1]#2{\marginnote{#2}\textbf{#1}\index{#2|bfhyperpage}}


\def\SeeIndex#1#2{\index{#1|see{#2}}}
\def\PropIndex#1{\index[properties]{#1|hyperpage}}

\def\bfhyperpage#1{{\bfseries\color{\indexcolor}\hyperpage{#1}}}

\setcounter{IndexColumns}{2}

\renewenvironment{theindex}
{\begin{multicols}\c@IndexColumns[\index@prologue][\IndexMin]%
    \IndexParms \let\item\@idxitem \ignorespaces}%
{\end{multicols}}

\renewcommand\@idxitem{\par\hangindent .75em}
\renewcommand\subitem{\par\hangindent 1.5em \hskip.75em\hb@xt@.75em{--\hss}}
\renewcommand\subsubitem{\par\hangindent 2.25em\hskip1.5em\hb@xt@.75em{--\hss}}




%%%%%%%%%%%%%%%
% CoCoTeX Doc %
%%%%%%%%%%%%%%%


%% Generic
\RequirePackage{fontawesome}
\def\ccDocSymbol#1{\ifvmode\leavevmode\fi\lower1\p@\hbox{#1}}
\def\ccDocString#1#2#3{{\small\ttfamily\mybfseries\color{#1}\if!#2!\else#2\,\fi#3}}

%% abstract container for doc elements
\ccDeclareContainer{CoCoDoc}{%
  \ccDeclareType{Components}{%
    \ccDeclareComp{Name}%
  }%
  \ccDeclareType{Attributes}{%
    \ccDeclareAttributeHandler*{noindex}{\let\noindex\relax}%
  }%
  \ccDeclareType{Properties}{%
    \ccSetProperty{color}{spot}
    \ccSetProperty{print-name}{\ccUseProperty{string-command}}%
    \ccSetProperty{index}{\index[\ccUseProperty{index-key}]{\actualchar\string\verb\quotechar*\verbatimchar\ccUseComp{Name}\verbatimchar\noexpand\doc@handleencap{main}}}%
    \ccSetProperty{index-key}{}%
    \ccSetProperty{string-command}{\ccDocString{\ccUseProperty{color}}{\ccUseProperty{symbol-command}}{\ccUseComp{Name}}%
    }%
    \ccSetProperty{symbol-command}{}
  }%
}

\def\DescriptonDomain#1{\def\description@domain{#1}}
\DescriptonDomain{}

%% intermediary, abstract container for doc elements that are sensitive to a description domain
\ccDeclareContainer{DomainedDoc}{%
  \ccInherit{Components,Properties,Attributes}{CoCoDoc}%
  \ccDeclareType{Properties}{%
    \ccSetProperty{index}{\index[\ccUseProperty{index-key}]{\actualchar\string\verb\quotechar*\verbatimchar\ccUseComp{Name}\verbatimchar\space(\description@domain)\noexpand\doc@handleencap{main}}}%
  }
}

\def\ccDoc{\cc@opt@empty\cc@doc}
\def\cc@doc[#1]#2#3{%
  \if@nobreak\vskip-\parskip\else\vskip\baselineskip\fi\par
  \bgroup
    \ccSetContainer{#2}%
    \ccEvalType{Properties}%
    \ccEvalAttributes[CoCoDoc]{#1}%
    #3%
    \ccUseProperty{print-name}%
    \ifx\noindex\relax\else\ccUseProperty{index}\fi%
  \egroup\par
  \@noskipsecfalse
  \@afterindentfalse
  \nopagebreak
  \@afterheading
}

%%%%%%%%%%%%%%
% Properties %
%%%%%%%%%%%%%%
\def\PropertySymbol{\ccDocSymbol\faGear}
\def\PropertyString#1{\ccDocString{propcolor!75}{\PropertySymbol}{#1}}

\ccDeclareContainer{Properties}{%
  \ccInherit{Components,Attributes,Properties}{DomainedDoc}%
  \ccDeclareType{Components}{%
    \ccDeclareComp{Args}%
    \ccDeclareComp{Default}%
  }%
  \ccDeclareType{Properties}{%
    \ccSetProperty{print-name}{%
      \PropertyString{\ccUseComp{Name}}%
      \enskip
      \bgroup
        \small\color{propcolor!50}[\ccIfCompEmpty{Default}{<empty>}{\ccUseComp{Default}}]%
      \egroup
      \ccWhenComp{Args}{\hfill{\small \ccUseComp{args}}}%
    }%
    \ccSetProperty{index-key}{properties}%
  }%
}

\newcommand\DescribeProp[4][]{%
  \cc@doc[#1]{Properties}{%
    \ccComponent{Name}{#2}%
    \ccComponent{Args}{#3}%
    \ccComponent{Default}{#4}%
  }%
}

% Index only
\def\UsageProperty#1{\index[properties]{#1\actualchar\string\verb\quotechar*\verbatimchar\string#1\verbatimchar\space(\description@domain)\noexpand\doc@handleencap{usage}}}
% Print and Index
\def\UsageProp#1{\PropertyString{#1}\UsageProperty{#1}}
% for Properties that are not declared by the user, but result from CoCoTeX internal processes
\def\DescribeImplicitProp#1{% \describeUProp
  \vskip\baselineskip\par
    {\bfseries\ttfamily #1}\ifx\noindex\relax\else\index[properties]{#1\actualchar\string\verb\quotechar*\verbatimchar\string#1\verbatimchar\space(\description@domain)\noexpand\doc@handleencap{main}}\fi}



%%%%%%%%%%%%%%
% Containers %
%%%%%%%%%%%%%%
\def\ContainerSymbol{\ccDocSymbol\faCube}
\def\ContainerString#1{\ccDocString{contcolor!75}{\ContainerSymbol}{#1}}
\ccDeclareContainer{Container}{%
  \ccInherit{Components,Attributes,Properties}{CoCoDoc}%
  \ccDeclareType{Properties}{%
    \ccSetProperty{color}{contcolor!75}
    \ccSetProperty{index-key}{containers}
    \ccSetProperty{symbol-command}{\ContainerSymbol}
  }}
\newcommand\DescribeContainer[2][]{\cc@doc[#1]{Container}{\ccComponent{Name}{#2}}}
\def\UsageContainer#1{\ccDocString{contcolor}{\ContainerSymbol}{#1}\index[containers]{#1\actualchar\string\verb\quotechar*\verbatimchar\string#1\verbatimchar\noexpand\doc@handleencap{usage}}}

%%%%%%%%%%%%%%
% Components %
%%%%%%%%%%%%%%
\def\ComponentSymbol{\ccDocSymbol\faSignIn}
\def\ComponentString#1{\ccDocString{compcolor!75}{\ComponentSymbol}{#1}}
\ccDeclareContainer{Component}{%
  \ccInherit{Components,Attributes,Properties}{DomainedDoc}%
  \ccDeclareType{Components}{%
    \ccDeclareComp{Add}%
  }
  \ccDeclareType{Properties}{%
    \ccSetProperty{color}{compcolor!75}
    \ccSetProperty{index-key}{components}
    \ccSetProperty{symbol-command}{\ComponentSymbol}
    \ccSetProperty{print-name}{%
      \ccUseProperty{string-command}%
      \ccWhenComp{Add}{\space(\ccUseComp{Add})}
      \egroup
    }
  }}
\newcommand\DescribeComponent[2][]{\cc@doc[#1]{Component}{\ccComponent{Name}{#2}}}
\newcommand\DescribeLabeledComp[2][]{\cc@doc[#1]{Component}{\ccComponent{Name}{#2}\ccComponent{Add}{LC}}}
\newcommand\DescribeCountedComp[2][]{\cc@doc[#1]{Component}{\ccComponent{Name}{#2}\ccComponent{Add}{CC}}}
\newcommand\DescribeGroupComp[2][]{\cc@doc[#1]{Component}{\ccComponent{Name}{#2}\ccComponent{Add}{GC}}}
\newcommand\DescribeCollectionComp[2][]{\cc@doc[#1]{Component}{\ccComponent{Name}{#2}\ccComponent{Add}{CL}}}
\newcommand\DescribeOverrideComp[2][]{\cc@doc[#1]{Component}{\ccComponent{Name}{#2}\ccComponent{Add}{OR}}}
\def\UsageComp#1{\index[components]{#1\actualchar\string\verb\quotechar*\verbatimchar\string#1\verbatimchar\space(\description@domain)\noexpand\doc@handleencap{usage}}}

%%%%%%%%%
% Hooks %
%%%%%%%%%
\def\HookSymbol{\ccDocSymbol\faIndent}
\def\HookString#1{\ccDocString{hookcolor!75}{\HookSymbol}{#1}}
\ccDeclareContainer{Hook}{%
  \ccInherit{Components,Attributes,Properties}{CoCoDoc}%
  \ccDeclareType{Properties}{%
    \ccSetProperty{color}{hookcolor!75}
    \ccSetProperty{index-key}{hooks}
    \ccSetProperty{symbol-command}{\HookSymbol}
  }}
\newcommand\DescribeHook[2][]{\cc@doc[#1]{Hook}{\ccComponent{Name}{#2}}}
\def\UsageHook#1{\ccDocString{hookcolor}{\HookSymbol}{#1}\index[hooks]{#1\actualchar\string\verb\quotechar*\verbatimchar\string#1\verbatimchar\noexpand\doc@handleencap{usage}}}


%%%%%%%%
% Tags %
%%%%%%%%
\def\TagSymbol{\ccDocSymbol\faTag}
\def\TagString#1{\ccDocString{tagscolor!75}{\TagSymbol}{#1}}
% Tag Description
\def\DescribeTag#1{\ccDocString{tagscolor}{\TagSymbol}{<#1/>}\index[tags]{#1\actualchar\string\verb\quotechar*\verbatimchar\string#1\verbatimchar\noexpand\doc@handleencap{main}}}
% Tag usage
\def\UsageTag#1{\TagString{#1}\index[tags]{#1\actualchar\string\verb\quotechar*\verbatimchar\string#1\verbatimchar\noexpand\doc@handleencap{usage}}}
% Start tag usage
\def\UsageTagS#1{\ccDocString{tagscolor}{\TagSymbol}{<#1>}\index[tags]{#1\actualchar\string\verb\quotechar*\verbatimchar\string#1\verbatimchar\noexpand\doc@handleencap{usage}}}
% End tag usage
\def\UsageTagE#1{\ccDocString{tagscolor}{\TagSymbol}{</#1>}\index[tags]{#1\actualchar\string\verb\quotechar*\verbatimchar\string#1\verbatimchar\noexpand\doc@handleencap{usage}}}

%%%%%%%%%%%%%%
% Attributes %
%%%%%%%%%%%%%%
\def\AttrSymbol{\ccDocSymbol\faChain}
\def\AttrString#1{\ccDocString{attrcolor!75}{\AttrSymbol}{#1}}
% Attr Description, #1 name, #2 expected value
\ccDeclareContainer{Attribute}{%
  \ccInherit{Components,Attributes,Properties}{DomainedDoc}%
  \ccDeclareType{Components}{%
    \ccDeclareComp{ExpVal}%
  }%
  \ccDeclareType{Properties}{%
    \ccSetProperty{color}{attrcolor!75}
    \ccSetProperty{index-key}{attributes}
    \ccSetProperty{symbol-command}{\AttrSymbol}
    \ccSetProperty{print-name}{%
      \ccUseProperty{string-command}\enskip
      \bgroup
        \ttfamily\footnotesize\mybfseries\color{attrcolot!50}%
        \ccUseComp{ExpVal}
      \egroup
    }}}
\newcommand\DescribeAttr[3][]{\cc@doc[#1]{Hook}{\ccComponent{Name}{#2}\ccComponent{ExpVal}{#3}}}
\def\UsageAttr#1{\AttrString{#1}\index[attributes]{#1\actualchar\string\verb\quotechar*\verbatimchar\string#1\verbatimchar\space(\description@domain)\noexpand\doc@handleencap{usage}}}

%%%%%%%%%%
% Macros %
%%%%%%%%%%
\def\MacroString#1{\ccDocString{spot!75}{}{#1}}

\def\DeclareMacro#1{\marginnote{\string#1}\MacroString{\string#1}\bgroup\def\HDorg@index{\index[macros]}\SpecialMainMacroIndex{#1}\egroup}
\def\UsageMacro#1{\MacroString{\string#1}\bgroup\let\cclt@index\index\def\index{\cclt@index[macros]}\SpecialMacroIndex{#1}\egroup}
\def\main#1{\textbf{#1}}
\def\usage#1{#1}
%%%%%%%%%%%%%
% Arguments %
%%%%%%%%%%%%%

\newdimen\LeftMarg \LeftMarg=2.5em\relax
\newenvironment{ArgList}{%
  \ifhmode\par\vskip\parskip\fi
  \begingroup
    \@tempcnta\z@
    \leftskip\LeftMarg
    \parskip\z@
    \def\item{\@ifstar{\let\is@opt\relax\describe@arg}{\describe@arg}}%
}{\par\endgroup}
\def\describe@arg{\@ifnextchar[{\@describe@arg}{\advance\@tempcnta\@ne\@describe@arg[\the\@tempcnta]}}%]
\def\@describe@arg[#1]{%
  \ifhmode\par\fi
  \hskip-\LeftMarg
  \hb@xt@\LeftMarg{%
    \color{spot}%
    \ttfamily
    \footnotesize
    \ifx\is@opt\relax[\##1]\else\{\##1\}\fi\enskip\hss}%
  \let\is@opt\@undefined
  \ignorespaces}

\def\InlineArg{\@ifstar{\let\is@opt\relax\inline@arg}{\inline@arg}}
\def\inline@arg#1{\begingroup
    \color{spot}\ttfamily\footnotesize
    \ifx\is@opt\relax[\##1]\else\{\##1\}\fi
  \endgroup
  \let\is@opt\@undefined}


\newenvironment{indented}{%
  \par
  \leftskip1em
  \small
  \tabcolsep4pt
}{\par}

\endinput
